<div class="absolute inset-0 flex min-w-0 flex-col overflow-hidden">
    <mat-drawer-container class="bg-card h-full flex-auto dark:bg-transparent" (backdropClick)="onBackdropClicked()">
        <!-- Drawer -->
        <mat-drawer class="w-full dark:bg-gray-900 sm:w-128" [mode]="drawerMode" [opened]="false" [position]="'end'"
            [disableClose]="true" #matDrawer>
            <router-outlet></router-outlet>
        </mat-drawer>

        <mat-drawer-content class="flex flex-col">

            <div class="flex min-w-0 flex-auto flex-col">
                <!-- Header -->
                <div class="bg-card">
                    <div class="mx-auto flex w-full max-w-screen-xl flex-col px-6 sm:px-8">
                        <div class="my-4 flex min-w-0 flex-auto flex-col sm:my-8 sm:flex-row sm:items-center">
                            <!-- Title -->
                            <div class="flex min-w-0 flex-auto items-center">
                                <div
                                    class="h-16 w-16 flex-0 overflow-hidden items-center justify-center rounded-full bg-primary-100 p-4 text-primary-700 dark:bg-primary dark:text-on-primary">
                                    <mat-icon class="h-full w-full text-current"
                                        [svgIcon]="'heroicons_outline:calendar-days'"></mat-icon>
                                </div>
                                <div class="ml-4 flex min-w-0 flex-col">
                                    <div
                                        class="truncate text-2xl font-semibold leading-7 tracking-tight md:text-5xl md:leading-snug">
                                        {{ 'dashboard.appointments.title' | transloco }}
                                    </div>
                                </div>
                            </div>
                            <!-- Actions -->
                            <div class="mt-6 flex items-center space-x-3 sm:ml-2 sm:mt-0">
                                <button mat-flat-button [color]="'primary'" [routerLink]="['new']">
                                    <mat-icon class="icon-size-5" [svgIcon]="'heroicons_outline:plus'"></mat-icon>
                                    <span class="ml-2"> {{ 'commons.buttons.add' | transloco }} </span>
                                </button>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Main -->
                <div class="-mt-px flex-auto border-t pt-4 sm:pt-6">
                    <div class="mx-auto w-full max-w-screen-xl">
                        <!-- Tabs -->
                        <mat-tab-group class="sm:px-2" mat-stretch-tabs="false" [animationDuration]="'0'">
                            <!-- Home -->
                            <mat-tab label="{{ 'dashboard.appointments.tabs.home' | transloco }}">
                                <ng-template matTabContent>
                                    <div class="grid w-full min-w-0 grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-4">
                                        <!-- Summary -->
                                        <div
                                            class="bg-card flex flex-auto flex-col overflow-hidden rounded-2xl p-4 shadow">
                                            <!-- <div class="flex items-start justify-between">
                                                <div class="truncate text-lg font-medium leading-6 tracking-tight">
                                                    {{ 'dashboard.appointments.counters.summary.title' | transloco }}
                                                </div>

                                            </div> -->
                                            <div class="flex flex-col items-center">
                                                <div
                                                    class="text-7xl font-bold leading-none tracking-tight text-dark-500 sm:text-8xl">
                                                    {{ dashboardInfo.counters.appointments.total }}
                                                </div>
                                                <!-- <div class="text-lg font-medium text-dark-600 dark:text-dark-500">
                                                    {{ 'dashboard.appointments.counters.summary.type' | transloco }}
                                                </div> -->
                                                <div class="text-lg font-medium text-dark-600 dark:text-dark-500">
                                                    {{ 'dashboard.appointments.counters.summary.title' | transloco }}
                                                </div>

                                            </div>
                                        </div>
                                        <!-- Today -->
                                        <div
                                            class="bg-card flex flex-auto flex-col overflow-hidden rounded-2xl p-4 shadow">
                                            <!-- <div class="flex items-start justify-between">
                                                <div class="truncate text-lg font-medium leading-6 tracking-tight">
                                                    {{ 'dashboard.appointments.counters.today.title' | transloco }}
                                                </div>
                                            </div> -->
                                            <div class="flex flex-col items-center">
                                                <div
                                                    class="text-7xl font-bold leading-none tracking-tight text-green-500 sm:text-8xl">
                                                    {{ dashboardInfo.counters.appointments.today }}
                                                </div>
                                                <div class="text-lg font-medium text-green-600 dark:text-green-500">
                                                    {{ 'dashboard.appointments.counters.today.title' | transloco }}
                                                </div>
                                                <!-- <div
                                                    class="text-secondary mt-5 flex w-full items-baseline justify-center">
                                                    <div class="truncate text-md font-medium">
                                                        {{ 'dashboard.appointments.counters.today.subtitle' |
                                                        transloco }}:
                                                    </div>
                                                    <div class="ml-1.5 text-lg font-semibold">
                                                        {{ dashboardInfo.counters.appointments.today_completed }}
                                                    </div>
                                                </div> -->
                                            </div>
                                        </div>
                                        <!-- Overdue -->
                                        <div
                                            class="bg-card flex flex-auto flex-col overflow-hidden rounded-2xl p-4 shadow">
                                            <!-- <div class="flex items-start justify-between">
                                                <div class="truncate text-lg font-medium leading-6 tracking-tight">
                                                    {{ 'dashboard.appointments.counters.overdue.title' | transloco }}
                                                </div>
                                                <div class="-mr-3 -mt-2 ml-2">

                                                </div>
                                            </div> -->
                                            <div class="flex flex-col items-center">
                                                <div
                                                    class="text-7xl font-bold leading-none tracking-tight text-red-500 sm:text-8xl">
                                                    {{ ( dashboardInfo.counters.appointments.past -
                                                    dashboardInfo.counters.appointments.completed -
                                                    dashboardInfo.counters.appointments.cancelled ) ?? 0 }}
                                                </div>
                                                <div class="text-lg font-medium text-red-600 dark:text-red-500">
                                                    {{ 'dashboard.appointments.counters.overdue.title' | transloco }}
                                                </div>
                                                <!-- <div
                                                    class="text-secondary mt-5 flex w-full items-baseline justify-center">
                                                    <div class="truncate text-md font-medium">
                                                        {{ 'dashboard.appointments.counters.overdue.subtitle' |
                                                        transloco }}:
                                                    </div>
                                                    <div class="ml-1.5 text-lg font-semibold">
                                                        {{ dashboardInfo.counters.appointments.cancelled }}
                                                    </div>
                                                </div> -->
                                            </div>
                                        </div>
                                        <!-- Next -->
                                        <div
                                            class="bg-card flex flex-auto flex-col overflow-hidden rounded-2xl p-4 shadow">
                                            <!-- <div class="flex items-start justify-between">
                                                <div class="truncate text-lg font-medium leading-6 tracking-tight">
                                                    {{ 'dashboard.appointments.counters.next.title' | transloco }}
                                                </div>
                                            </div> -->
                                            <div class="flex flex-col items-center">
                                                <div
                                                    class="text-7xl font-bold leading-none tracking-tight text-blue-500 sm:text-8xl">
                                                    {{ dashboardInfo.counters.appointments.future }}
                                                </div>
                                                <div class="text-lg font-medium text-blue-600 dark:text-blue-500">
                                                    {{ 'dashboard.appointments.counters.next.title' | transloco }}
                                                </div>
                                                <!-- <div
                                                    class="text-secondary mt-5 flex w-full items-baseline justify-center">
                                                    <div class="truncate text-md font-medium">
                                                        {{ 'dashboard.appointments.counters.next.subtitle' |
                                                        transloco }}:
                                                    </div>
                                                    <div class="ml-1.5 text-lg font-semibold">
                                                        {{ dashboardInfo.counters.appointments.pending }}
                                                    </div>
                                                </div> -->
                                            </div>
                                        </div>

                                        <!-- Schedule -->
                                        <div
                                            class="bg-card bg-default flex flex-auto flex-col overflow-hidden rounded-2xl p-6 shadow sm:col-span-2 md:col-span-4 lg:col-span-4">
                                            <div class="flex flex-col items-start justify-between sm:flex-row">
                                                <div class="truncate text-lg font-medium leading-6 tracking-tight">
                                                    {{ 'dashboard.appointments.schedule.title' | transloco }}
                                                </div>
                                                <div class="mt-3 sm:ml-2 sm:mt-0">
                                                    <mat-button-toggle-group value="today"
                                                        #scheduleDaySelector="matButtonToggleGroup"
                                                        (change)="onToggleScheduleDaySelectorChange(scheduleDaySelector.value)">
                                                        <mat-button-toggle value="today">
                                                            {{ 'dashboard.appointments.schedule.buttons.today' |
                                                            transloco: { count: todayAppointments.length } }}
                                                        </mat-button-toggle>
                                                        <mat-button-toggle value="tomorrow">
                                                            {{ 'dashboard.appointments.schedule.buttons.tomorrow' |
                                                            transloco: { count: tomorrowAppointments.length } }}
                                                        </mat-button-toggle>
                                                        <mat-button-toggle value="next">
                                                            {{ 'dashboard.appointments.schedule.buttons.next' |
                                                            transloco: { count: nextAppointments.length } }}
                                                        </mat-button-toggle>
                                                    </mat-button-toggle-group>
                                                </div>
                                            </div>
                                            <div class="mt-2 flex flex-col divide-y">
                                                @if(appointmentList.length < 1){ <div
                                                    class="border-t p-8 text-center text-4xl font-semibold tracking-tight sm:p-16">
                                                    {{ 'dashboard.appointments.schedule.labels.no_records' | transloco
                                                    }}
                                            </div>
                                            }
                                            @for (
                                            scheduleItem of appointmentList;
                                            track trackByFn($index, scheduleItem)
                                            ) {
                                            <div class="flex flex-row items-center justify-between px-0.5 py-4">
                                                <div class="flex flex-col">
                                                    <div class="font-medium">
                                                        {{ scheduleItem.reason }}
                                                    </div>
                                                    <!-- Today -->
                                                    <div
                                                        class="-ml-0.5 mt-2 flex flex-col space-y-1 sm:mt-1 sm:flex-row sm:items-center sm:space-x-3 sm:space-y-0">
                                                        @if (scheduleDaySelector.value == 'today') {
                                                        <div class="flex items-center">
                                                            <mat-icon class="text-hint icon-size-5" [svgIcon]="
                                                                    'heroicons_solid:clock'
                                                                "></mat-icon>
                                                            <div class="text-secondary ml-1.5 text-md">
                                                                {{
                                                                scheduleItem.startAt | date:'shortTime'
                                                                }}
                                                            </div>
                                                        </div>
                                                        }
                                                        @if (scheduleDaySelector.value == 'tomorrow') {
                                                        <div class="flex items-center">
                                                            <mat-icon class="text-hint icon-size-5" [svgIcon]="
                                                                    'heroicons_solid:calendar'
                                                                "></mat-icon>
                                                            <div class="text-secondary ml-1.5 text-md">
                                                                {{ scheduleItem.startAt | date: 'mediumDate' }}
                                                            </div>
                                                        </div>
                                                        <div class="flex items-center">
                                                            <mat-icon class="text-hint icon-size-5" [svgIcon]="
                                                                    'heroicons_solid:clock'
                                                                "></mat-icon>
                                                            <div class="text-secondary ml-1.5 text-md">
                                                                {{ scheduleItem.startAt | date: 'h:mm a' }}
                                                            </div>
                                                        </div>
                                                        }
                                                        @if(scheduleDaySelector.value == 'next'){


                                                        <div class="flex items-center">
                                                            <mat-icon class="text-hint icon-size-5" [svgIcon]="
                                                                    'heroicons_solid:calendar'
                                                                "></mat-icon>
                                                            <div class="text-secondary ml-1.5 text-md">
                                                                {{ scheduleItem.startAt | date: 'longDate' }}
                                                            </div>
                                                        </div>
                                                        <div class="flex items-center">
                                                            <mat-icon class="text-hint icon-size-5" [svgIcon]="
                                                                    'heroicons_solid:clock'
                                                                "></mat-icon>
                                                            <div class="text-secondary ml-1.5 text-md">
                                                                {{ scheduleItem.startAt | date: 'h:mm a' }}
                                                            </div>
                                                        </div>
                                                        }
                                                        @if (
                                                        scheduleItem.doctorId
                                                        ) {
                                                        <div class="flex items-center">
                                                            <mat-icon class="text-hint icon-size-5" [svgIcon]="
                                                                    'heroicons_solid:lifebuoy'
                                                                "></mat-icon>
                                                            <div class="text-secondary ml-1.5 text-md">
                                                                {{
                                                                scheduleItem.doctorName +
                                                                ' ' +
                                                                scheduleItem.doctorLastName
                                                                }}
                                                            </div>
                                                        </div>
                                                        }
                                                        @if (
                                                        scheduleItem.patientId
                                                        ) {
                                                        <div class="flex items-center">
                                                            <mat-icon class="text-hint icon-size-5" [svgIcon]="
                                                                    'heroicons_solid:user'
                                                                "></mat-icon>
                                                            <div class="text-secondary ml-1.5 text-md">
                                                                {{
                                                                scheduleItem.patientName +
                                                                ' ' +
                                                                scheduleItem.patientLastName
                                                                }}
                                                            </div>
                                                        </div>
                                                        }


                                                    </div>
                                                </div>


                                                <button mat-icon-button [routerLink]="[scheduleItem.id]">
                                                    <mat-icon [svgIcon]="
                                                        'heroicons_mini:chevron-right'
                                                    "></mat-icon>
                                                </button>
                                            </div>
                                            }
                                        </div>
                                    </div>
                    </div>
                    </ng-template>
                    </mat-tab>

                    <!-- Doctors -->
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <span class="inline-flex items-center space-x-2">
                                <span class="">{{ 'dashboard.appointments.tabs.doctors' | transloco }}</span>
                                <span class="rounded-full bg-primary-100 px-2 py-1 text-sm text-on-primary-100">{{
                                    dashboardInfo.doctors.length }}</span>
                            </span>
                        </ng-template>
                        <ng-template matTabContent>
                            <div
                                class="grid w-full min-w-0 grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
                                @for (doctor of dashboardInfo.doctors; track doctor) {
                                <div
                                    class="bg-card flex flex-auto flex-col items-center overflow-hidden rounded-2xl shadow">
                                    <!-- Avatar & Info -->
                                    <div class="flex w-full flex-auto flex-col p-8 text-center">

                                        <div class="mx-auto h-32 w-32 overflow-hidden rounded-full">
                                            @if (doctor.avatar) {
                                            <img class="h-full w-full object-cover" [src]="doctor.avatar"
                                                alt="{{ doctor.name }}" />
                                            }
                                            @if (!doctor.avatar) {
                                            <div
                                                class="flex h-full w-full items-center justify-center rounded-full bg-gray-200 text-6xl uppercase text-gray-600 dark:bg-gray-700 dark:text-gray-200">
                                                {{ doctor.name.charAt(0) }}
                                            </div>
                                            }
                                        </div>
                                        <div class="mt-6 font-medium">
                                            {{ doctor.name }} {{ doctor.last_name }}
                                        </div>
                                        <div class="text-secondary">
                                            {{ doctor.specialty }}
                                        </div>
                                    </div>
                                    <!-- Email & Phone -->
                                    <div class="flex w-full items-center divide-x border-t">
                                        <a class="flex flex-auto items-center justify-center py-4 hover:bg-hover"
                                            [href]="'mailto:' + doctor.user_email">
                                            <mat-icon class="text-hint icon-size-5" [svgIcon]="
                                                    'heroicons_solid:envelope'
                                                "></mat-icon>
                                            <span class="ml-2">Email</span>
                                        </a>
                                        <a class="flex flex-auto items-center justify-center py-4 hover:bg-hover"
                                            [href]="'tel:' + doctor.phone">
                                            <mat-icon class="text-hint icon-size-5" [svgIcon]="
                                                    'heroicons_solid:phone'
                                                "></mat-icon>
                                            <span class="ml-2">Call</span>
                                        </a>
                                    </div>
                                </div>
                                }
                            </div>
                        </ng-template>
                    </mat-tab>

                    <!-- Patients -->
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <span class="inline-flex items-center space-x-2">
                                <span class="">{{ 'dashboard.appointments.tabs.patients' | transloco }}</span>
                                <span class="rounded-full bg-primary-100 px-2 py-1 text-sm text-on-primary-100">{{
                                    dashboardInfo.patients.length }}</span>
                            </span>
                        </ng-template>
                        <ng-template matTabContent>
                            <div
                                class="grid w-full min-w-0 grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
                                @for (patient of dashboardInfo.patients; track patient) {
                                <div
                                    class="bg-card flex flex-auto flex-col items-center overflow-hidden rounded-2xl shadow">
                                    <!-- Avatar & Info -->
                                    <div class="flex w-full flex-auto flex-col p-8 text-center">

                                        <div class="mx-auto h-32 w-32 overflow-hidden rounded-full">
                                            @if (!patient.avatar) {
                                            <div
                                                class="flex h-full w-full items-center justify-center rounded-full bg-gray-200 text-6xl uppercase text-gray-600 dark:bg-gray-700 dark:text-gray-200">
                                                {{ patient.name.charAt(0) }}
                                            </div>
                                            }
                                        </div>
                                        <div class="mt-6 font-medium">
                                            {{ patient.name }} {{ patient.last_name }}
                                        </div>
                                        <!-- <div class="text-secondary">
                                        
                                    </div> -->
                                    </div>
                                    <!-- Email & Phone -->
                                    <div class="flex w-full items-center divide-x border-t">
                                        <a class="flex flex-auto items-center justify-center py-4 hover:bg-hover"
                                            [href]="'mailto:' + patient.user_email">
                                            <mat-icon class="text-hint icon-size-5" [svgIcon]="
                                                    'heroicons_solid:envelope'
                                                "></mat-icon>
                                            <span class="ml-2">{{ "commons.labels.email" | transloco }}</span>
                                        </a>
                                        <a class="flex flex-auto items-center justify-center py-4 hover:bg-hover"
                                            [href]="'tel:' + patient.phone">
                                            <mat-icon class="text-hint icon-size-5" [svgIcon]="
                                                    'heroicons_solid:phone'
                                                "></mat-icon>
                                            <span class="ml-2"><span class="ml-2">{{ "commons.labels.call" |
                                                    transloco }}</span></span>
                                        </a>
                                    </div>
                                </div>
                                }
                            </div>
                        </ng-template>
                    </mat-tab>
                    </mat-tab-group>
                </div>
            </div>
</div>

</mat-drawer-content>
</mat-drawer-container>
</div>